{% extends "sheets/base.html" %}
{% load static from staticfiles %}

{% block title %}
    {{ sheet.title }}
{% endblock title %}

{% block page-content %}
    <div class="row">
        <!-- #### FIRST ROW #### -->
        <div class="col s12">
            <a class="waves-effect waves-light btn" href="{% url "sheets:list"%}" style="margin:auto;">
                <i class="material-icons left">replay</i>
                Back
            </a>
        </div>

        <!-- #### SECOND ROW #### -->
        <div class="col s1 valign-wrapper" style="height:100vh;">
                <a id="previousButton"
                   class="btn-floating btn-small waves-effect waves-light teal lighten-3"
                   style="margin:auto;">
                    <i class="material-icons">skip_previous</i>
                </a>
        </div>

        <div class="col s5">
            <img id="firstImage" src="{% static images.0 %}" style="height:95vh; display:block; margin:auto;">
        </div>

        <div class="col s5">
            {% if sheet.number_of_pages > 1 %}
                <img id="secondImage" src="{% static images.1 %}" style="height:95vh; display:block; margin:auto;">
            {% endif %}
        </div>

        <div class="col s1 valign-wrapper" style="height:100vh;">
            <a id="nextButton"
               class="btn-floating btn-small waves-effect waves-light teal lighten-3"
               style="margin:auto;">
                <i class="material-icons">skip_next</i>
            </a>
        </div>
    </div>
{% endblock page-content %}

{% block page-scripts %}
    <script>
            var firstPage = 0;
            var images = {{ images|safe }}

            function checkButtonsEnablings() {
                if (firstPage <= 0) {
                    $("#previousButton").hide();
                }
                else {
                    $("#previousButton").show();
                }

                if (firstPage >= {{ sheet.number_of_pages }} - 2) {
                    $("#nextButton").hide();
                }
                else {
                    $("#nextButton").show();
                }
            }

            function loadImages() {
                $("#firstImage").attr("src", "/static/" + images[firstPage]);
                if (firstPage < {{ sheet.number_of_pages }} - 1)
                {
                    $("#secondImage").attr("src", "/static/" + images[firstPage + 1]);
                }
            }

            $("#previousButton").click(function() {
                if (firstPage > 0){
                    firstPage--;
                    checkButtonsEnablings();
                    loadImages();
                }
            });

            $("#nextButton").click(function() {
                if (firstPage < {{ sheet.number_of_pages }} - 2){
                    firstPage++;
                    checkButtonsEnablings();
                    loadImages();
                }
            });

            $(document).ready(checkButtonsEnablings);
    </script>
{% endblock page-scripts %}
